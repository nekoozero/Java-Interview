# 小白在linux安装mysql

mysql装了好几次，每次都费一大堆事，实在是受不了了，就以小白的方式先记录下来吧。

环境：Centos7，mysql5.7.24

首先将tar.gz压缩包解压出来，放在/usr/local/mysql目录下，并执行命令：

```
[root@localhost local]# groupadd mysql   //添加用户组
[root@localhost local]# useradd -r -g mysql mysql //将mysql用户添加到mysql组中去
[root@localhost local]# [root@localhost local]# chown -R mysql:mysql mysql

# chown -R   "权限"或"名"："组" 文件夹名称
* useradd -r参数表示mysql用户是系统用户，不可用于登录系统。
* useradd -g参数表示把mysql用户添加到mysql用户组中。
```

配置mysql的服务，将support-files下的mysql.server 复制到 /etc/init.d/下并取个名字

```
[root@localhost mysql]# cp support-files/mysql.server /etc/init.d/mysql
```

修改/etc/init.d/mysql的参数

```
vi /etc/init.d/mysql
```

修改
basedir=/usr/local/mysql 
datadir=/usr/local/mysql/data

下面是配置mysql的配置文件，修改/etc/my.cnf,没有则新建一个

```
# *** DO NOT EDIT THIS FILE. It's a template which will be copied to the
# *** default location during install, and will be replaced if you
# *** upgrade to a newer version of MySQL.
[client]
port = 3306
default-character-set=utf8

[mysqld]
# 一般配置选项
basedir = /usr/local/mysql
datadir = /usr/local/mysql/data
port = 3306
character-set-server=utf8
default_storage_engine = InnoDB
socket=/var/lib/mysql/mysql.sock  //记住这个配置
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0
# Settings user and group are ignored when systemd is used.
# If you need to run mysqld under a different user or group,
# customize your systemd unit file for mariadb according to the
# instructions in http://fedoraproject.org/wiki/Systemd

[mysqld_safe]
#log-error=/var/log/mariadb/mariadb.log
#pid-file=/var/run/mariadb/mariadb.pid

#
# include all files from the config directory
#
!includedir /etc/my.cnf.d

```


然后切换到mysql的bin目录执行下面命令初始化数据库

```
./mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data
```
记录下生成的密码。

执行 service mysql start,则会报错：

ERROR! The server quit without updating PID file (/usr/local/mysql/data/promote.cache-dns.local.pid).

这是要到/var/lib/mysql下赋予一下文件的权限。

执行命令：

```
chown -R mysql:mysql /var/lib/mysql
```

再次执行service mysql start ,mysql服务启动成功。

到bin目录下面：

```
./mysql -h 127.0.0.1 -u root -p
```
之后输入密码，进入到数据库中之后要立即重置密码：

```
set password=password('新密码');
flush privileges;
```


为了方便进入mysql，需要配置一下环境变量：vi /etc/profile

```
export MYSQL_HOME=/usr/local/mysql
export PATH=$MYSQL_HOME/bin:$PATH   //这个好像要写在$PATH前面
```

然后source /etc/profile。即可。

解决进入mysql需要输入-h 127.0.0.1:

首先看/etm/my.cnf中socket=所指向的路径，然后添加软链接把这个路径指向'/tmp/mysql.sock' 。语句：ln -s /var/lib/mysql/mysql.sock /tmp/mysql.sock
解释：
（1）/var/lib/mysql /mysql.sock是my.cnf中socket所指向的路径。

参考文章：
[原文链接](https://blog.csdn.net/Nicolas12/article/details/81813682)
[原文链接](https://blog.csdn.net/bao19901210/article/details/51917641)
[原文链接](https://blog.csdn.net/qq_37185081/article/details/78840552)